# Checker Contract

Can be used to replace content validation using the blockchain directly instead of relying on subgraphs.

## Development

Install dependencies with:

```
npm ci
```

## ABI

There is an `abi.json` file inside the scripts folder.

It can be generated by running:

```
$ npx hardhat run ./scripts/abi.ts
```

This is just a helper to have the Checker ABI more accessible, It can also be found when compiling the contract on:

```
./artifacts/contracts/Checker.sol/Checker.json (The Json has an abi property)
```

## Bytecode

There is a `bytecode.json` file inside the scripts folder, it has to be regenerated every time the contract changes in order to be able to run:

- `./scripts/checkLAND/checkLAND.ts`
- `./scripts/checkName/checkName.ts`
- `./scripts/validateThirdParty/validateThirdParty.ts`
- `./scripts/validateWearables/validateWearables.ts`

To regenerate it, simply run:

```
$ npx hardhat run ./scripts/bytecode.ts
```

## Scripts

Inside the `./scripts` directory, there are four different subdirectories containing scripts to execute calls to the `Checker` contract functions with various parameters to check the results.

If you dive into the different function directories, you'll find a main script called the same as the directory containing it.

You can run those by executing, in the case of `checkLAND`:

```
$ npx hardhat run ./scripts/checkLAND/checkLAND.ts --network mainnet
```

This will run all tests inside the file in the same directory that has a `.test.ts` suffix.

The `--network` flag determines the suite of tests for a given network that have to be run.

A file with `.calls.ts` suffix might be found as well, these serve as a way to check individually the different calls the Checker makes to the provided contracts. For example, `checkLAND` function will make various calls to the LAND and Estate contracts to check the permissions of the provided `sender`.

This file is called with:

```
$ npx hardhat run ./scripts/checkLAND/checkLAND.calls.ts --network mainnet
```

A file that ends with `.multi.ts` will call the contract's `multicall` function used to do multiple calls to functions inside the Checker. That function is just a utility to avoid making unnecessary rpc calls when only 1 might suffice.

```
$ npx hardhat run ./scripts/checkLAND/checkLAND.multi.ts --network mainnet
```
